#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>

// Flags
int r = 0;
int j = 0;
int s = 0;

int line_width = 72;

int main(int argc, char *argv[]) {

    printf("argc: %d\n", argc);
    for (int i = 1; i < argc; i++) {
        printf("segfault 1?");
        if (strcmp("-w", argv[i]) == 0) {
            printf("segfault 2?");
            if (i <= (argc - 1)) {
                printf("segfault 3?");
                if (isdigit(*argv[i + 1])) {
                    printf("segfault 4?");
                    line_width = atoi(argv[i + 1]);
                }
            } else {
                printf("%s","you goofed");
            }
        }
        if (strcmp("-s", argv[i]) == 0) {
            s = 1;
        }
    }

    printf("Line width: %d\n", line_width);
    printf("Skip line: %d\n", s);
    char word[100];
    char c = 0;

    int line_l = 0;
    int word_l = 0;

    c = fscanf(stdin, "%s" , word);
    while (c != EOF) {
        word_l = strlen(word);

        if ((line_l + word_l) <= line_width) {
            printf("%s ", word);
            line_l += word_l + 1;
        } else {
            line_l = word_l;
            printf("\n%s ", word);
        }

        int ch = getchar();
        int nextch = 0;

        while(ch == '\n') {
            if ((nextch= getchar()) == '\n') {
                printf("\n\n");
                ch = getchar();
                while(ch == '\n') {
                    if (s == 0) {
                        printf("%c", ch);
                    }
                    ch = getchar();
                }
                line_l= 0;
            }
            ch = getchar();
        }
        ungetc(ch, stdin);

        c = fscanf(stdin, "%s" , word);
    }
}
